
@{
    ViewBag.Title = "Index";
}

<h2>Dashboard</h2>
@section head_scripts{
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        // Load the Visualization API and the corechart package.
        google.charts.load('current', { 'packages': ['corechart'] });

        // Set a callback to run when the Google Visualization API is loaded.
        google.charts.setOnLoadCallback(drawChart);

        // Callback that creates and populates a data table,
        // instantiates the pie chart, passes in the data and
        // draws it.
        function drawChart() {

            // Create the data table.
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Name');
            data.addColumn('number', 'Mass');

            // Set chart options
            var options = {
                'title': "Meteorite's Mass",
                'width': 600,
                'height': 500,
                'vAxis':{
                    'title': 'Mass (g)',
                    'titleTextStyle': {
                        fontSize: 18
                    }
                },
                'hAxis': {
                    'title': 'Meteorites',
                    'titleTextStyle': {
                        fontSize: 18
                    },
                    'textPosition': 'none'
                },
                legend: { position: "none" }
            };

            $.ajax({
                url: '@Url.Action("MeteoritesColumnChart", "Charts")',
                datatype: "json",
                type: "get",
                async: false,
                data: {},
                contentType: 'application/json; charset=utf-8',
                success: function (d) {
                    $.each(d, function (index, item) {
                        data.addRow([item.Name, item.Mass]);
                    });
                },
                error: function (xhr) {
                    alert("Error " + xhr);
                }
            });

            // Instantiate and draw our chart, passing in some options.
            var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
            chart.draw(data, options);
        };

        // Load the Visualization API and the corechart package.
            //google.charts.load('current', {
            //    'packages': ['geochart'],
            //    // Note: you will need to get a mapsApiKey for your project.
            //    // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
            //    'mapsApiKey': 'AIzaSyCSH3BBrOUOnUqikhHl7C0gWCYnzeErz1Q'//'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
            //});
        google.charts.load('current', { 'packages': ['map'] });

        // Set a callback to run when the Google Visualization API is loaded.
        google.charts.setOnLoadCallback(drawMarkersMap);

        function drawMarkersMap() {
            var data = new google.visualization.DataTable();
            data.addColumn('number', 'Latitude');
            data.addColumn('number', 'Longitude');
            data.addColumn('string', 'Name');

            //var data = google.visualization.arrayToDataTable([
            //    ['Lat', 'Long', 'Name'],
            //    [-113, 6.08333, 'Work'],
            //    [56.183330, 10.233330, 'University'],
            //    [-30.866670, -64.550000, 'Airport'],
            //]);

            var options = {
                showTooltip: true,
                showInfoWindow: true
            };

            $.ajax({
                url: '@Url.Action("MeteoritesGeoChart", "Charts")',
                datatype: "json",
                type: "get",
                async: false,
                data: {},
                contentType: 'application/json; charset=utf-8',
                success: function (d) {
                    $.each(d, function (index, item) {
                        data.addRow([item.Latitude, item.Longitude, item.Name]);
                    });
                },
                error: function (xhr) {
                    alert("Error " + xhr);
                }
            });

            //plotting chart on element with id = 'chart_div'
            var chart = new google.visualization.Map(document.getElementById('geochart_div'));
            chart.draw(data, options);

            console.log(data)
        };

        google.charts.load('current', { 'packages': ['table'] });
        google.charts.setOnLoadCallback(drawTableChart);

        function drawTableChart() {

            //var data = google.visualization.arrayToDataTable([
            //    ['Task', 'Hours per Day'],
            //    ['Work', 11],
            //    ['Eat', 2],
            //    ['Commute', 2],
            //    ['Watch TV', 2],
            //    ['Sleep', 7]
            //]);
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Name');
            data.addColumn('number', 'Mass');
            data.addColumn('number', 'Latitude');
            data.addColumn('number', 'Longitude');

            var options = {
                title: 'Meteorites Info',
                'width': 600,
                'height': 400
            };

            $.ajax({
                url: '@Url.Action("MeteoritesTableChart", "Charts")',
                datatype: "json",
                type: "get",
                async: false,
                data: {},
                contentType: 'application/json; charset=utf-8',
                success: function (d) {
                    $.each(d, function (index, item) {
                        data.addRow([item.Name, item.Mass, item.Latitude, item.Longitude]);
                    });
                },
                error: function (xhr) {
                    alert("Error " + xhr);
                }
            });

            var chart = new google.visualization.Table(document.getElementById('tablechart'));

            chart.draw(data, options);
        }
    </script>
}
    <table>
        <tr>
            <td><div id="chart_div"></div></td>
            <td><div id="tablechart"></div></td>
        </tr>
    </table>

                <div id="geochart_div"></div>
